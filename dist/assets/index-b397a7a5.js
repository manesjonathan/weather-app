(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(e){if(e.ep)return;e.ep=!0;const r=t(e);fetch(e.href,r)}})();const C="ba1044fe2a7ec122f93be5c606c204f4",E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function L(a){let n=[],t={};for(let o=0;o<a.list.length;o++){let e=a.list[o],r=new Date(e.dt*1e3),c=E[r.getDay()],s=A(e.main.temp);switch(c){case"Monday":let i=e.weather[0].icon;n.push({day:c,temp:s,icon:i});break;case"Tuesday":let l=e.weather[0].icon;n.push({day:c,temp:s,icon:l});break;case"Wednesday":let h=e.weather[0].icon;n.push({day:c,temp:s,icon:h});break;case"Thursday":let p=e.weather[0].icon;n.push({day:c,temp:s,icon:p});break;case"Friday":let d=e.weather[0].icon;n.push({day:c,temp:s,icon:d});break;case"Saturday":let y=e.weather[0].icon;n.push({day:c,temp:s,icon:y});break;case"Sunday":let u=e.weather[0].icon;n.push({day:c,temp:s,icon:u});break}t[c]={day:c,count:0,sum:0,average:0,icon:null},n.forEach(i=>{c==i.day&&(t[i.day].sum+=i.temp,t[i.day].count++,t[i.day].average=t[i.day].sum/t[i.day].count,t[i.day].icon=i.icon)})}return Object.entries(t)}function A(a){return Math.floor(a-273.15)}const O=document.querySelector(".chart-canvas"),k=O.getContext("2d");function D(a){Chart.defaults.global.defaultFontColor="#fff";let n={responsive:!0,maintainAspectRatio:!1,legend:{display:!1},scales:{x:{ticks:{color:"red"}},y:{ticks:{color:"green"}},xAxes:[{gridLines:{display:!1}}],yAxes:[{gridLines:{display:!1}}]}};new Chart(k,{type:"line",data:{labels:a.map(t=>t[0]),datasets:[{label:"Average temperature",data:a.map(t=>t[1].average),fill:!1,borderColor:"rgb(75, 192, 192)",tension:.5,borderWidth:3}]},options:n})}const v=document.querySelector(".city"),x=document.querySelector(".submit-button"),S=document.querySelector(".weather-section"),T=new URL(""+new URL("day-d12efbc1.webp",import.meta.url).href,self.location).pathname,q=new URL(""+new URL("night-d44508cb.webp",import.meta.url).href,self.location).pathname,m=new Date().getHours(),P=m>8&&m<20;P===!0?document.body.style.backgroundImage=`url(${T})`:document.body.style.backgroundImage=`url(${q})`;let f=JSON.parse(localStorage.getItem("user-city"));f!==null&&(v.value=f[0]);x.addEventListener("click",()=>{let a=[],n=v.value.split(",");for(let t=0;t<n.length;t++)a.push(n[t].replaceAll(" ",""));localStorage.setItem("user-city",JSON.stringify(a)),I(a)});async function I(a){if(S.innerHTML=null,Array.isArray(a))for(let t=0;t<a.length;t++){let o=a[t],e=await g(o),r=e[0],c=e[1],s=await w(r,c);b(o,s)}else{let t=await g(a),o=t[0],e=t[1],r=await w(o,e);b(a,r)}}async function g(a){const n=`https://api.openweathermap.org/geo/1.0/direct?q=${a}&limit=1&appid=${C}`;try{const o=await(await fetch(n)).json();let e=o[0].lat,r=o[0].lon;return[e,r]}catch(t){window.alert(t)}}async function w(a,n){const t=`https://api.openweathermap.org/data/2.5/forecast?lat=${a}&lon=${n}&appid=${C}`;try{return await(await fetch(t)).json()}catch(o){window.alert(o)}}function b(a,n){const t=L(n),o=document.createElement("section");o.className="inner-section";const e=document.createElement("div");e.className="div-day";const r=document.createElement("h3");r.innerText=a.toUpperCase(),e.appendChild(r);for(let c=0;c<t.length;c++){let s=t[c];const i=document.createElement("article"),l=document.createElement("img");let p=`https://openweathermap.org/img/wn/${s[1].icon}@2x.png`;l.setAttribute("src",p),i.appendChild(l);const d=document.createElement("h2");let y=s[1].average.toFixed(1);d.innerText=y+"Â°C",i.appendChild(d);const u=document.createElement("h4");u.innerText=s[0],i.appendChild(u),o.appendChild(i),e.appendChild(o)}S.appendChild(e),D(t)}
